<!DOCTYPE html>
<html lang="ro">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>O Invita»õie SpecialƒÉ</title>
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@600;700&family=Nunito:wght@400;700&display=swap" rel="stylesheet">
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        :root {
            --bg-gradient: linear-gradient(135deg, #fdfbfb 0%, #ebedee 100%);
            --book-cover: #eec0c6;
            --book-gradient: linear-gradient(315deg, #eec0c6 0%, #7ee8fa 74%);
            --paper-color: #fffdf9;
            --text-color: #4a4a4a;
            --accent-color: #d46a6a;
            --font-head: 'Dancing Script', cursive;
            --font-body: 'Nunito', sans-serif;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background-image: linear-gradient(to top, #fff1eb 0%, #ace0f9 100%);
            overflow: hidden;
            font-family: var(--font-body);
            color: var(--text-color);
        }

        /* --- 3D Book Container --- */
        .scene {
            width: 84vw; /* Mobile optimized width */
            max-width: 600px;
            height: 60vh;
            max-height: 500px;
            perspective: 1500px;
            position: relative;
            margin-bottom: 30px;
        }

        .book {
            width: 100%;
            height: 100%;
            position: relative;
            transform-style: preserve-3d;
        }

        /* --- Pages --- */
        .page {
            width: 50%;
            height: 100%;
            position: absolute;
            top: 0;
            right: 0; /* All pages start on the right */
            transform-origin: left center;
            transition: transform 1s cubic-bezier(0.645, 0.045, 0.355, 1);
            transform-style: preserve-3d;
            cursor: pointer;
        }

        .page.flipped {
            transform: rotateY(-180deg);
        }

        /* --- Page Faces (Front/Back) --- */
        .face {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            background-color: var(--paper-color);
            /* Paper texture effect */
            background-image: 
                linear-gradient(to right, rgba(0,0,0,0.1) 0%, rgba(0,0,0,0) 5%, rgba(0,0,0,0) 95%, rgba(0,0,0,0.1) 100%),
                url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='%239C92AC' fill-opacity='0.05'%3E%3Cpath d='M11 18c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm48 25c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm-43-7c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm63 31c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM34 90c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm56-76c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM12 86c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm28-65c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm23-11c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-6 60c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm29 22c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zM32 63c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm57-13c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-9-21c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM60 91c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM35 41c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM12 60c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2z'/%3E%3C/g%3E%3C/svg%3E");
            
            border: 1px solid #e0e0e0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
            text-align: center;
            box-shadow: inset 5px 0 10px rgba(0,0,0,0.05);
        }

        .face.front {
            z-index: 2;
        }

        .face.back {
            transform: rotateY(180deg);
            z-index: 1;
            background-image: 
                linear-gradient(to left, rgba(0,0,0,0.1) 0%, rgba(0,0,0,0) 5%, rgba(0,0,0,0) 95%, rgba(0,0,0,0.1) 100%),
                url("data:image/svg+xml,..."); /* Same pattern */
        }

        /* --- Typography & Content --- */
        h1, h2, h3 {
            font-family: var(--font-head);
            color: var(--accent-color);
            line-height: 1.2;
        }

        h1 { font-size: 2.5rem; margin-bottom: 1rem; }
        h2 { font-size: 2rem; margin-bottom: 0.5rem; }
        p { font-size: 1.1rem; line-height: 1.6; min-height: 1.6em;}

        .typewriter-text {
            display: inline-block;
        }
        
        .typewriter-cursor {
            display: inline-block;
            width: 2px;
            height: 1em;
            background-color: var(--accent-color);
            animation: blink 1s infinite;
            vertical-align: bottom;
        }

        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0; }
        }

        /* --- Specific Page Styles --- */
        .photo-placeholder {
            width: 80%;
            height: 120px;
            background: #eee;
            border: 2px dashed #ccc;
            border-radius: 8px;
            margin: 15px auto;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #aaa;
            font-size: 0.9rem;
            overflow: hidden;
        }

        .photo-placeholder img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
            border-radius: 6px;
            border: none;
        }

        .date-list {
            list-style: none;
            text-align: left;
            width: 100%;
            padding: 0 15px;
            margin-top: 20px;
        }
        .date-list li {
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .btn-group {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }

        .action-btn {
            padding: 8px 20px;
            border: none;
            border-radius: 25px;
            font-family: var(--font-body);
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .btn-yes {
            background: var(--accent-color);
            color: white;
            font-size: 1.2rem;
        }

        .btn-no {
            background: #e0e0e0;
            color: #666;
            font-size: 1rem;
        }

        .action-btn:active {
            transform: scale(0.95);
        }

        /* --- Navigation Controls --- */
        .controls {
            display: flex;
            gap: 20px;
            background: rgba(255, 255, 255, 0.6);
            padding: 10px 20px;
            border-radius: 50px;
            backdrop-filter: blur(5px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            z-index: 100;
        }

        .control-btn {
            background: none;
            border: none;
            cursor: pointer;
            color: var(--text-color);
            display: flex;
            align-items: center;
            gap: 5px;
            font-family: var(--font-body);
            font-weight: 700;
            transition: color 0.3s;
        }

        .control-btn:hover {
            color: var(--accent-color);
        }

        .control-btn.active {
            color: var(--accent-color);
        }

        /* --- Status Message --- */
        #status-message {
            margin-top: 15px;
            height: 20px;
            font-weight: bold;
            color: var(--accent-color);
            font-size: 1.1rem;
            text-align: center;
            opacity: 0;
            transition: opacity 0.5s;
        }

        /* --- Confetti Canvas --- */
        #confetti-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 999;
        }

        /* Responsive adjustments for very small screens */
        @media (max-width: 400px) {
            h1 { font-size: 2rem; }
            h2 { font-size: 1.5rem; }
            .page { width: 48%; } /* Prevent overlap */
        }
    </style>
</head>
<body>

    <!-- Confetti Canvas -->
    <canvas id="confetti-canvas"></canvas>

    <!-- The 3D Book -->
    <div class="scene">
        <div class="book" id="book">
            
            <!-- Page 1: Intro -->
            <div class="page" id="p1">
                <div class="face front">
                    <h1 class="animate-text">Hei Iubire...</h1>
                    <i data-lucide="heart" color="#d46a6a" size="48" fill="#d46a6a" style="opacity: 0.5; margin-top: 20px;"></i>
                    <p style="margin-top: auto; font-size: 0.9rem; opacity: 0.6;">Deschide pentru o surprizƒÉ &rarr;</p>
                </div>
                <div class="face back">
                    <!-- Back of Page 1 (Left side of spread 1) -->
                    <p>De ziua ta mergem undeva...</p>
                </div>
            </div>

            <!-- Page 2: Destination -->
            <div class="page" id="p2">
                <div class="face front">
                    <h2>Mergem la...</h2>
                    <div class="photo-placeholder">
                        <img src="images/image.png" alt="Fotografie Destina»õie" class="destination-photo" loading="lazy">
                    </div>
                    <p class="animate-text">Doar noi doi.</p>
                </div>
                <div class="face back">
                    <p>Am pregƒÉtit totul.</p>
                </div>
            </div>

            <!-- Page 3: Dates -->
            <div class="page" id="p3">
                <div class="face front">
                    <h2>NoteazƒÉ Datele!</h2>
                    <ul class="date-list">
                        <li><i data-lucide="calendar" size="20"></i> <span>9 Decembrie</span></li>
                        <li><i data-lucide="clock" size="20"></i> <span>3 Zile & 2 Nop»õi</span></li>
                        <li><i data-lucide="map-pin" size="20"></i> <span>La munte</span></li>
                    </ul>
                    <p class="animate-text" style="margin-top: 20px;">ElibereazƒÉ-»õi programul.</p>
                </div>
                <div class="face back">
                    <p>Doar un singur lucru a mai rƒÉmas...</p>
                </div>
            </div>

            <!-- Page 4: The Ask -->
            <div class="page" id="p4">
                <div class="face front">
                    <h2>Deci...</h2>
                    <i data-lucide="car-front" size="64" color="#4a4a4a" style="margin: 20px 0;"></i>
                    <p class="animate-text">Vii cu mine √Æn aceastƒÉ aventurƒÉ?</p>
                    
                    <div class="btn-group">
                        <button class="action-btn btn-no" onclick="handleResponse(false)">Nu</button>
                        <button class="action-btn btn-yes" onclick="handleResponse(true)">Da! ‚ù§Ô∏è</button>
                    </div>
                </div>
                <div class="face back">
                    <!-- End of book -->
                </div>
            </div>

        </div>
    </div>

    <!-- Controls -->
    <div class="controls">
        <button class="control-btn" onclick="goPrev()">
            <i data-lucide="chevron-left"></i>
        </button>
        <!-- Auto play button removed -->
        <button class="control-btn" onclick="goNext()">
            <i data-lucide="chevron-right"></i>
        </button>
    </div>

    <!-- Toast/Status Message -->
    <div id="status-message"></div>

    <script>
        // --- State Management ---
        let currentPage = 0; // 0 means closed (cover visible)
        const pages = Array.from(document.querySelectorAll('.page'));
        const totalPages = pages.length;
        let typeWriterTimeout;

        // --- Initialization ---
        lucide.createIcons();
        assignZIndexes();
        // Trigger text on cover immediately
        animateTextForPage(0);

        // --- Core Page Turning Logic ---
        function assignZIndexes() {
            // Dynamic Z-Index Strategy:
            // Pages on the Right Stack need z-index: (Total - Index)
            // Pages on the Left Stack need z-index: (Index)
            
            pages.forEach((page, index) => {
                if (index < currentPage) {
                    // Page is on the LEFT (flipped)
                    page.style.zIndex = index + 1; 
                } else {
                    // Page is on the RIGHT (unflipped)
                    page.style.zIndex = totalPages - index;
                }
            });
        }

        function goNext() {
            if (currentPage < totalPages) {
                const page = pages[currentPage];
                page.classList.add('flipped');
                currentPage++;
                assignZIndexes();
                animateTextForPage(currentPage); // Animate text on the new visible page (Right side usually P(i+1))
            }
        }

        function goPrev() {
            if (currentPage > 0) {
                currentPage--;
                const page = pages[currentPage];
                page.classList.remove('flipped');
                assignZIndexes();
                // When going back, we animate the page that lands on the Right
                animateTextForPage(currentPage); 
            }
        }

        // --- Typewriter Effect ---
        function animateTextForPage(pageIndex) {
            // If pageIndex is 0, we are looking at Cover (P1 Front)
            // If pageIndex is 1, we just flipped P1. Now looking at P1 Back (Left) and P2 Front (Right).
            // We want to animate the Front face of the Right stack.
            
            // Map current logical page index to the actual DOM element index
            let targetPageIndex = pageIndex;
            
            // If we are at the very end (currentPage = 4), we are looking at P4 Back. No text there.
            if (targetPageIndex >= totalPages) return;

            const pageEl = pages[targetPageIndex];
            const frontFace = pageEl.querySelector('.face.front');
            const textEl = frontFace.querySelector('.animate-text'); // Only animate designated elements

            if (textEl) {
                // Cancel previous animation
                clearTimeout(typeWriterTimeout);
                
                // Store original text if not stored yet
                if (!textEl.dataset.originalText) {
                    textEl.dataset.originalText = textEl.innerText;
                }
                
                const fullText = textEl.dataset.originalText;
                textEl.innerText = ""; // Clear
                textEl.innerHTML = '<span class="typewriter-text"></span><span class="typewriter-cursor"></span>';
                
                const span = textEl.querySelector('.typewriter-text');
                let charIndex = 0;

                function type() {
                    if (charIndex < fullText.length) {
                        span.textContent += fullText.charAt(charIndex);
                        charIndex++;
                        typeWriterTimeout = setTimeout(type, 50); // Typing speed
                    } else {
                        // Remove cursor after done
                        const cursor = textEl.querySelector('.typewriter-cursor');
                        if(cursor) cursor.style.display = 'none';
                    }
                }
                
                // Small delay before typing starts so the page flip can finish slightly
                setTimeout(type, 500);
            }
        }

        // --- Final Interaction ---
        function handleResponse(isYes) {
            const msgBox = document.getElementById('status-message');
            
            if (isYes) {
                msgBox.textContent = "Yaaay! Abia a»ôtept! ‚ù§Ô∏è";
                msgBox.style.opacity = 1;
                startConfetti();
            } else {
                msgBox.textContent = "Prea t√¢rziu, am rezervat deja! üòâ";
                msgBox.style.opacity = 1;
            }
        }

        // --- Confetti Engine (Lightweight) ---
        function startConfetti() {
            const canvas = document.getElementById('confetti-canvas');
            const ctx = canvas.getContext('2d');
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;

            const particles = [];
            const particleCount = 150;

            for (let i = 0; i < particleCount; i++) {
                particles.push({
                    x: Math.random() * canvas.width,
                    y: Math.random() * canvas.height - canvas.height,
                    w: Math.random() * 10 + 5,
                    h: Math.random() * 10 + 5,
                    dx: Math.random() * 4 - 2,
                    dy: Math.random() * 5 + 2,
                    color: `hsl(${Math.random() * 360}, 70%, 80%)`,
                    rotation: Math.random() * 360
                });
            }

            function animateConfetti() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                
                particles.forEach(p => {
                    ctx.save();
                    ctx.translate(p.x + p.w/2, p.y + p.h/2);
                    ctx.rotate(p.rotation * Math.PI / 180);
                    ctx.fillStyle = p.color;
                    ctx.fillRect(-p.w/2, -p.h/2, p.w, p.h);
                    ctx.restore();

                    p.y += p.dy;
                    p.x += p.dx;
                    p.rotation += 2;

                    if (p.y > canvas.height) {
                        p.y = -20;
                        p.x = Math.random() * canvas.width;
                    }
                });

                requestAnimationFrame(animateConfetti);
            }
            
            animateConfetti();
        }
        
        // Handle Window Resize for Confetti
        window.addEventListener('resize', () => {
            const canvas = document.getElementById('confetti-canvas');
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        });

    </script>
</body>
</html>